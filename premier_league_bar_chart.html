
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Premier League Club Financials</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <link rel="stylesheet" href="https://use.typekit.net/xxs6huv.css">
  <style>
    body {
      background-color: #000000;
      color: white;
      font-family: 'aglet-sans', sans-serif;
      padding: 20px;
      margin: 0;
      min-height: 100vh;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background-color: #000000;
    }
    .controls-container { 
      display: flex; 
      flex-wrap: wrap; 
      justify-content: center; 
      margin-bottom: 30px; 
      gap: 20px; 
    }
    .control-group {
      background-color: rgba(5, 212, 190, 0.1);
      padding: 15px;
      border-radius: 8px;
      border: 1px solid rgba(5, 212, 190, 0.3);
    }
    label { 
      font-size: 1rem; 
      margin-right: 10px; 
      color: #05D4BE; 
    }
    select {
      font-size: 1rem;
      padding: 8px 15px;
      background-color: #121212;
      color: white;
      border: 1px solid #05D4BE;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'aglet-sans', sans-serif;
    }
    select:hover { background-color: #1D3B48; }
    .charts-container { display: flex; flex-direction: column; gap: 20px; }
    .chart-wrapper {
      background-color: rgba(5, 212, 190, 0.05);
      border-radius: 8px;
      padding: 10px;
      border: 1px solid rgba(5, 212, 190, 0.2);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .metrics-cards {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 15px;
    }
    .metric-card {
      background: linear-gradient(135deg, rgba(5, 212, 190, 0.2), rgba(95, 132, 251, 0.2));
      border-radius: 8px;
      padding: 15px;
      flex: 1;
      min-width: 200px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(5, 212, 190, 0.3);
      text-align: center;
    }
    .metric-value { font-size: 2rem; font-weight: bold; margin: 10px 0; color: #05D4BE; }
    .metric-title { font-size: 1rem; color: #cccccc; }
    .metric-change { font-size: 0.9rem; }
    .positive-change { color: #4CD964; }
    .negative-change { color: #FF3B30; }
    .footer { text-align: center; margin-top: 30px; font-size: 0.8rem; color: #666; }
    
    /* D3 Chart Styles */
    .bar { transition: all 0.3s ease; }
    .bar:hover { filter: brightness(1.2); }
    .axis-x path, .axis-y path { stroke: rgba(255, 255, 255, 0.3); }
    .axis-x .tick line, .axis-y .tick line { stroke: rgba(128, 128, 128, 0.2); }
    .axis-x text, .axis-y text { fill: white; font-size: 12px; font-family: 'aglet-sans', sans-serif; }
    .chart-title { fill: white; font-size: 18px; font-weight: bold; font-family: 'aglet-sans', sans-serif; text-anchor: middle; }
    .average-line { stroke: rgba(255, 255, 255, 0.7); stroke-width: 2; stroke-dasharray: 5,5; }
    .average-label { fill: white; font-size: 12px; font-family: 'aglet-sans', sans-serif; }
    .bar-value { fill: white; font-size: 10px; font-family: 'aglet-sans', sans-serif; text-anchor: middle; }
    .tooltip { 
      position: absolute; 
      padding: 10px; 
      background: #1D3B48; 
      color: white; 
      border: 1px solid #05D4BE; 
      border-radius: 5px; 
      pointer-events: none;
      font-family: 'aglet-sans', sans-serif;
      font-size: 14px;
      opacity: 0;
      transition: opacity 0.3s;
      z-index: 10;
    }
    
    #debugInfo { 
      background-color: rgba(5, 212, 190, 0.1); 
      padding: 10px; 
      margin-top: 20px; 
      border-radius: 5px; 
      white-space: pre; 
      font-family: 'aglet-sans', monospace; 
      font-size: 0.8rem; 
      max-height: 150px; 
      overflow: auto; 
      display: none; 
    }
    .awaiting-accounts-bar {
      fill: rgba(150, 150, 150, 0.3);
      stroke: rgba(255, 255, 255, 0.5);
      stroke-width: 1;
    }
    @media (max-width: 768px) {
      .controls-container { flex-direction: column; align-items: center; }
      .metric-card { min-width: 100%; }
    }
  </style>
</head>
<body>
  <div class="container">    
    <div class="controls-container">
      <div class="control-group">
        <label for="yearSelect">Financial Year:</label>
        <select id="yearSelect"></select>
      </div>
      
      <div class="control-group">
        <label for="metricSelect">Financial Metric:</label>
        <select id="metricSelect">
          <option value="revenue">Revenue</option>
          <option value="wages">Wages</option>
          <option value="amortisation">Player Amortisation</option>
        </select>
      </div>
      
      <div class="control-group">
        <label for="sortSelect">Sort By:</label>
        <select id="sortSelect">
          <option value="value">Value (Descending)</option>
          <option value="name">Club Name</option>
          <option value="change">Year-over-year Change</option>
        </select>
      </div>
    </div>
    
    <div class="metrics-cards">
      <div class="metric-card">
        <div class="metric-title">Highest Value</div>
        <div id="highestValue" class="metric-value">£0M</div>
        <div id="highestClub" class="metric-subtitle">-</div>
      </div>
      
      <div class="metric-card">
        <div class="metric-title">League Total</div>
        <div id="leagueTotal" class="metric-value">£0M</div>
        <div id="totalChange" class="metric-change">-</div>
      </div>
      
      <div class="metric-card">
        <div class="metric-title">Highest Year-on-Year Growth</div>
        <div id="highestGrowth" class="metric-value">0%</div>
        <div id="growthClub" class="metric-subtitle">-</div>
      </div>
    </div>
    
    <div class="charts-container">
      <div class="chart-wrapper">
        <div id="barChart" style="width: 100%; height: 500px;"></div>
      </div>
      
      <div class="chart-wrapper">
        <div id="trendChart" style="width: 100%; height: 450px;"></div>
      </div>
    </div>
    
    <div id="debugInfo"></div>
    
          <div class="footer">
      Data last updated: 2025-04-10 15:38:13 | Source: Premier League Financial Records 2015-2024
      <div><small>Double-click on chart area to show data info</small></div>
    </div>
  </div>
  
  <div id="tooltip" class="tooltip"></div>
  
  <script>
    // Embedded data from SQL
    var rawData = [{"year":2022,"team":"West Ham United","revenue":252720000.0,"wages":135709000.0,"amortisation":48825000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":31.1278070649,"wages_pct_change":4.8553216148,"amortisation_pct_change":-15.4618647736,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2023,"team":"West Ham United","revenue":236656000.0,"wages":136844000.0,"amortisation":65306000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-6.356441912,"wages_pct_change":0.836348363,"amortisation_pct_change":33.7552483359,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2024,"team":"Liverpool","revenue":613764000.0,"wages":386086000.0,"amortisation":114479000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":3.3558086744,"wages_pct_change":3.5413442895,"amortisation_pct_change":6.4465438045,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2024,"team":"Brighton and Hove Albion","revenue":222549000.0,"wages":146221000.0,"amortisation":39374000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":8.8525311812,"wages_pct_change":14.6264982793,"amortisation_pct_change":20.1452459417,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2021,"team":"West Ham United","revenue":192728000.0,"wages":129425000.0,"amortisation":57755000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":38.1562724014,"wages_pct_change":1.6445327532,"amortisation_pct_change":-3.5100908848,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2020,"team":"West Ham United","revenue":139500000.0,"wages":127331000.0,"amortisation":59856000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2023,"team":"Brighton and Hove Albion","revenue":204450000.0,"wages":127563000.0,"amortisation":32772000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":21.7246860878,"wages_pct_change":10.6702873404,"amortisation_pct_change":-27.8753466262,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2022,"team":"Chelsea","revenue":481278000.0,"wages":340249000.0,"amortisation":162457000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":10.6734764742,"wages_pct_change":2.2060347547,"amortisation_pct_change":-0.8586388713,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2022,"team":"Brentford","revenue":142420000.0,"wages":68152000.0,"amortisation":22851000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2023,"team":"Liverpool","revenue":593836000.0,"wages":372881000.0,"amortisation":107546000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-0.0731989278,"wages_pct_change":1.8544518864,"amortisation_pct_change":4.7043246296,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2024,"team":"West Ham United","revenue":269740000.0,"wages":160969000.0,"amortisation":83489000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":13.9797850044,"wages_pct_change":17.6295635907,"amortisation_pct_change":27.8427709552,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2022,"team":"Liverpool","revenue":594271000.0,"wages":366092000.0,"amortisation":102714000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":21.9355103465,"wages_pct_change":16.4585149227,"amortisation_pct_change":-4.9138138527,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2023,"team":"Brentford","revenue":169018000.0,"wages":98800000.0,"amortisation":30903000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":18.6757477882,"wages_pct_change":44.9700669093,"amortisation_pct_change":35.2369699357,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2023,"team":"Fulham","revenue":181188000.0,"wages":139064000.0,"amortisation":45617000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":56.0808366211,"wages_pct_change":22.1241580385,"amortisation_pct_change":-19.1932969602,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2023,"team":"Chelsea","revenue":512467000.0,"wages":403962000.0,"amortisation":205000000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":6.4804541242,"wages_pct_change":18.7254040423,"amortisation_pct_change":26.1872372382,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2022,"team":"Brighton and Hove Albion","revenue":167961000.0,"wages":115264000.0,"amortisation":45438000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":20.7318914023,"wages_pct_change":5.8594467507,"amortisation_pct_change":-2.0310478655,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2021,"team":"Chelsea","revenue":434863000.0,"wages":332905000.0,"amortisation":163864000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":6.7405167378,"wages_pct_change":17.4350924227,"amortisation_pct_change":26.88766542,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2020,"team":"Brighton and Hove Albion","revenue":123508000.0,"wages":103178000.0,"amortisation":45616000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2021,"team":"Fulham","revenue":116086000.0,"wages":113871000.0,"amortisation":56452000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2020,"team":"Liverpool","revenue":489860000.0,"wages":325572000.0,"amortisation":107306000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2021,"team":"Liverpool","revenue":487365000.0,"wages":314354000.0,"amortisation":108022000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-0.5093291961,"wages_pct_change":-3.4456280024,"amortisation_pct_change":0.6672506663,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2021,"team":"Brighton and Hove Albion","revenue":139119000.0,"wages":108884000.0,"amortisation":46380000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":12.6396670661,"wages_pct_change":5.5302486964,"amortisation_pct_change":1.6748509295,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2020,"team":"Chelsea","revenue":407402000.0,"wages":283480000.0,"amortisation":129141000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2020,"team":"Leicester City","revenue":149950000.0,"wages":157479000.0,"amortisation":78273000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2021,"team":"Arsenal","revenue":327586000.0,"wages":237697000.0,"amortisation":117413000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-4.6198460925,"wages_pct_change":6.0654874523,"amortisation_pct_change":7.6058067709,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2020,"team":"Arsenal","revenue":343453000.0,"wages":224104000.0,"amortisation":109114000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2021,"team":"Leicester City","revenue":226204000.0,"wages":192088000.0,"amortisation":71953000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":50.8529509837,"wages_pct_change":21.9768985071,"amortisation_pct_change":-8.0743040384,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2022,"team":"Arsenal","revenue":369077000.0,"wages":212345000.0,"amortisation":124567000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":12.6656816836,"wages_pct_change":-10.6656794154,"amortisation_pct_change":6.0930220674,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2023,"team":"Leicester City","revenue":177326000.0,"wages":205780000.0,"amortisation":74724000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-17.3652080712,"wages_pct_change":13.0827100724,"amortisation_pct_change":3.3169720014,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2020,"team":"Tottenham Hotspur","revenue":402386000.0,"wages":181280000.0,"amortisation":75350000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2021,"team":"Tottenham Hotspur","revenue":361872000.0,"wages":204875000.0,"amortisation":73812000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-10.068441745,"wages_pct_change":13.015776699,"amortisation_pct_change":-2.0411413404,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2022,"team":"Leicester City","revenue":214590000.0,"wages":181973000.0,"amortisation":72325000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-5.134303549,"wages_pct_change":-5.2658156678,"amortisation_pct_change":0.5170041555,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2023,"team":"Arsenal","revenue":464557000.0,"wages":234766000.0,"amortisation":139060000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":25.8699404189,"wages_pct_change":10.5587605077,"amortisation_pct_change":11.6347026098,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2020,"team":"Manchester City","revenue":478359000.0,"wages":351412000.0,"amortisation":146285000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2021,"team":"Manchester City","revenue":569849000.0,"wages":354689000.0,"amortisation":145753000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":19.1258030057,"wages_pct_change":0.9325236475,"amortisation_pct_change":-0.3636736508,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2023,"team":"Manchester City","revenue":712768000.0,"wages":422895000.0,"amortisation":145448000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":16.2727115531,"wages_pct_change":19.5020359952,"amortisation_pct_change":3.3686783978,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2024,"team":"Arsenal","revenue":613546000.0,"wages":327822000.0,"amortisation":171099000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":32.0711990133,"wages_pct_change":39.637766968,"amortisation_pct_change":23.0396950956,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2022,"team":"Manchester City","revenue":613014000.0,"wages":353881000.0,"amortisation":140708000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":7.5748136787,"wages_pct_change":-0.227805204,"amortisation_pct_change":-3.4613352727,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2024,"team":"Wolverhampton Wanderers","revenue":177697000.0,"wages":141925000.0,"amortisation":64168000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":5.4112412873,"wages_pct_change":0.2302276146,"amortisation_pct_change":-19.0053644683,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2020,"team":"Wolverhampton Wanderers","revenue":132609000.0,"wages":94701000.0,"amortisation":51917000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2023,"team":"Nottingham Forest","revenue":154758000.0,"wages":144912000.0,"amortisation":40766000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2023,"team":"AFC Bournemouth","revenue":142997000.0,"wages":100109000.0,"amortisation":41226000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":41.4803308533,"wages_pct_change":-7.1956318195,"amortisation_pct_change":-12.6012295951,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2021,"team":"Wolverhampton Wanderers","revenue":194096000.0,"wages":139262000.0,"amortisation":62140000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":46.3671394853,"wages_pct_change":47.0544133642,"amortisation_pct_change":19.6910453223,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2023,"team":"Wolverhampton Wanderers","revenue":168575000.0,"wages":141599000.0,"amortisation":79225000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":1.7602424257,"wages_pct_change":17.4208688874,"amortisation_pct_change":30.088175892,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2020,"team":"AFC Bournemouth","revenue":101072000.0,"wages":107871000.0,"amortisation":47170000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2022,"team":"Wolverhampton Wanderers","revenue":165659000.0,"wages":120591000.0,"amortisation":60901000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-14.6509974446,"wages_pct_change":-13.4071031581,"amortisation_pct_change":-1.9938847763,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2022,"team":"Southampton","revenue":150628000.0,"wages":113449000.0,"amortisation":35134000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-4.2080829279,"wages_pct_change":0.0202775378,"amortisation_pct_change":-25.7993664203,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2023,"team":"Southampton","revenue":145539000.0,"wages":122492000.0,"amortisation":51993000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-3.3785219216,"wages_pct_change":7.970982556,"amortisation_pct_change":47.9848579723,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2021,"team":"Southampton","revenue":157245000.0,"wages":113426000.0,"amortisation":47350000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":24.1708518905,"wages_pct_change":-0.823656967,"amortisation_pct_change":-16.4519885662,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2020,"team":"Southampton","revenue":126636000.0,"wages":114368000.0,"amortisation":56674000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2022,"team":"Newcastle United","revenue":178185000.0,"wages":170204000.0,"amortisation":49721000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":30.0478049849,"wages_pct_change":59.3237791236,"amortisation_pct_change":54.0446757753,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2021,"team":"Everton","revenue":193143000.0,"wages":182570000.0,"amortisation":81243000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":3.9062415941,"wages_pct_change":10.8110076597,"amortisation_pct_change":-18.1282247662,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2022,"team":"Aston Villa","revenue":178399000.0,"wages":137044000.0,"amortisation":82535000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-2.8497211815,"wages_pct_change":-0.5478994768,"amortisation_pct_change":47.0556792873,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2021,"team":"Manchester United","revenue":464839000.0,"wages":312359000.0,"amortisation":120896000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-4.6405858942,"wages_pct_change":13.9210544551,"amortisation_pct_change":-2.1219751127,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2020,"team":"Manchester United","revenue":487460000.0,"wages":274189000.0,"amortisation":123517000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2023,"team":"Aston Villa","revenue":217694000.0,"wages":194236000.0,"amortisation":92519000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":22.0264687582,"wages_pct_change":41.7325822364,"amortisation_pct_change":12.0966862543,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2020,"team":"Everton","revenue":185882000.0,"wages":164758000.0,"amortisation":99232000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2023,"team":"Tottenham Hotspur","revenue":549633000.0,"wages":251121000.0,"amortisation":109073000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":23.7834100552,"wages_pct_change":20.0501960034,"amortisation_pct_change":37.1642354125,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2022,"team":"Tottenham Hotspur","revenue":444028000.0,"wages":209180000.0,"amortisation":79520000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":22.7030552239,"wages_pct_change":2.1012812691,"amortisation_pct_change":7.7331599198,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2023,"team":"Newcastle United","revenue":247314000.0,"wages":186679000.0,"amortisation":86811000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":38.7961949659,"wages_pct_change":9.6795609974,"amortisation_pct_change":74.5962470586,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2021,"team":"Newcastle United","revenue":137015000.0,"wages":106829000.0,"amortisation":32277000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-8.2873704785,"wages_pct_change":-11.8179717036,"amortisation_pct_change":-32.1355732638,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2022,"team":"Everton","revenue":181007000.0,"wages":162010000.0,"amortisation":68327000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-6.2834273052,"wages_pct_change":-11.2614339705,"amortisation_pct_change":-15.8979850572,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2021,"team":"Aston Villa","revenue":183632000.0,"wages":137799000.0,"amortisation":56125000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":63.0892749298,"wages_pct_change":26.6453445091,"amortisation_pct_change":-20.501706823,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2022,"team":"Manchester United","revenue":539937000.0,"wages":372533000.0,"amortisation":149455000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":16.1557012213,"wages_pct_change":19.2643720847,"amortisation_pct_change":23.6227832186,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2023,"team":"Manchester United","revenue":601313000.0,"wages":313775000.0,"amortisation":170355000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":11.3672521053,"wages_pct_change":-15.7725624307,"amortisation_pct_change":13.984142384,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2020,"team":"Aston Villa","revenue":112596000.0,"wages":108807000.0,"amortisation":70599000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2023,"team":"Everton","revenue":172155000.0,"wages":159026000.0,"amortisation":77621000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-4.8904186026,"wages_pct_change":-1.8418616135,"amortisation_pct_change":13.6022363048,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2020,"team":"Newcastle United","revenue":149396000.0,"wages":121146000.0,"amortisation":47561000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2024,"team":"Fulham","revenue":180686000.0,"wages":154754000.0,"amortisation":57400000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-0.277060291,"wages_pct_change":11.2825749295,"amortisation_pct_change":25.8302825701,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2024,"team":"Manchester City","revenue":715019000.0,"wages":412573000.0,"amortisation":165094000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":0.3158110353,"wages_pct_change":-2.4407949964,"amortisation_pct_change":13.5072328255,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2024,"team":"AFC Bournemouth","revenue":169049000.0,"wages":136170000.0,"amortisation":61616000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":18.2185640258,"wages_pct_change":36.0217363074,"amortisation_pct_change":49.4590792219,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2024,"team":"Nottingham Forest","revenue":189552000.0,"wages":166399000.0,"amortisation":61685000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":22.4828441825,"wages_pct_change":14.8276195208,"amortisation_pct_change":51.3148211745,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2024,"team":"Newcastle United","revenue":317453000.0,"wages":218738000.0,"amortisation":96744000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":28.3603030965,"wages_pct_change":17.1733296193,"amortisation_pct_change":11.4420983516,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2024,"team":"Manchester United","revenue":613444000.0,"wages":349507000.0,"amortisation":187347000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":2.0174185491,"wages_pct_change":11.3877778663,"amortisation_pct_change":9.9744650876,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2024,"team":"Everton","revenue":186902000.0,"wages":156631000.0,"amortisation":64581000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":8.5661177427,"wages_pct_change":-1.506043037,"amortisation_pct_change":-16.7995774339,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2024,"team":"Chelsea","revenue":468486000.0,"wages":338021000.0,"amortisation":191826000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-8.5822111473,"wages_pct_change":-16.3235650878,"amortisation_pct_change":-6.4263414634,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2024,"team":"Aston Villa","revenue":275695000.0,"wages":252049000.0,"amortisation":96548000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":26.6433617831,"wages_pct_change":29.7643073375,"amortisation_pct_change":4.3547811801,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2024,"team":"Crystal Palace","revenue":189224000.0,"wages":133712000.0,"amortisation":47142000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":5.085912943,"wages_pct_change":2.3624699524,"amortisation_pct_change":13.1100340707,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2022,"team":"Crystal Palace","revenue":159999000.0,"wages":123835000.0,"amortisation":35342000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":21.3188962944,"wages_pct_change":-2.4936615171,"amortisation_pct_change":-5.8701326373,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2023,"team":"Crystal Palace","revenue":180066000.0,"wages":130626000.0,"amortisation":41678000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":12.5419533872,"wages_pct_change":5.4839100416,"amortisation_pct_change":17.9276781167,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2021,"team":"Crystal Palace","revenue":131883000.0,"wages":127002000.0,"amortisation":37546000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-7.3510506017,"wages_pct_change":-4.25276871,"amortisation_pct_change":-15.9574706212,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2020,"team":"Crystal Palace","revenue":142347000.0,"wages":132643000.0,"amortisation":44675000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2024,"team":"Tottenham Hotspur","revenue":517763000.0,"wages":221929000.0,"amortisation":135803000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-5.7984145785,"wages_pct_change":-11.6246749575,"amortisation_pct_change":24.5065231542,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2022,"team":"Burnley","revenue":123407000.0,"wages":92120000.0,"amortisation":22703000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":7.2162709273,"wages_pct_change":7.1985477227,"amortisation_pct_change":6.0342814441,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2022,"team":"Watford","revenue":128094000.0,"wages":78969.0,"amortisation":29684.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":6.7583447931,"wages_pct_change":-99.9179124957,"amortisation_pct_change":-99.9254844864,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2024,"team":"Luton Town","revenue":132321856.0,"wages":56881016.0,"amortisation":9424952.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2020,"team":"Watford","revenue":119985000.0,"wages":96201000.0,"amortisation":39836000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2023,"team":"Leeds United","revenue":189683547.0,"wages":145857096.0,"amortisation":80899026.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":0.2519878134,"wages_pct_change":20.1403569765,"amortisation_pct_change":40.6527971371,"avg_revenue":301099677.3500000238,"total_revenue":6021993547.0,"avg_wages":201649354.8000000119,"total_wages":4032987096.0,"avg_amortisation":85927101.299999997,"total_amortisation":1718542026.0,"clubs_awaiting":0},{"year":2021,"team":"West Bromwich Albion","revenue":106934000.0,"wages":76897000.0,"amortisation":25391000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2020,"team":"Norwich City","revenue":119352000.0,"wages":88925000.0,"amortisation":8565000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2022,"team":"Norwich City","revenue":133869000.0,"wages":117992000.0,"amortisation":23414000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":12.1631811784,"wages_pct_change":32.6870958673,"amortisation_pct_change":173.368359603,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2024,"team":"Sheffield United","revenue":137599836.0,"wages":63703662.0,"amortisation":20375960.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":19.4224255951,"wages_pct_change":12.7132074681,"amortisation_pct_change":-20.9550737566,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2021,"team":"Sheffield United","revenue":115221103.0,"wages":56518365.0,"amortisation":25777695.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-19.5030099697,"wages_pct_change":-27.4343355144,"amortisation_pct_change":48.0662529938,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2020,"team":"Burnley","revenue":133813000.0,"wages":100094000.0,"amortisation":32315000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2021,"team":"Burnley","revenue":115101000.0,"wages":85934000.0,"amortisation":21411000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-13.9836936621,"wages_pct_change":-14.1467021,"amortisation_pct_change":-33.7428438806,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2022,"team":"Leeds United","revenue":189206769.0,"wages":121405579.0,"amortisation":57516827.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":10.6292868046,"wages_pct_change":12.1501842924,"amortisation_pct_change":52.1852676322,"avg_revenue":270387488.4499999881,"total_revenue":5407749769.0,"avg_wages":175705377.400000006,"total_wages":3514107548.0,"avg_amortisation":69224175.549999997,"total_amortisation":1384483511.0,"clubs_awaiting":0},{"year":2021,"team":"Leeds United","revenue":171027740.0,"wages":108252679.0,"amortisation":37793952.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":241290442.150000006,"total_revenue":4825808843.0,"avg_wages":171781852.1999999881,"total_wages":3435637044.0,"avg_amortisation":69467732.349999994,"total_amortisation":1389354647.0,"clubs_awaiting":0},{"year":2020,"team":"Sheffield United","revenue":143137157.0,"wages":77885823.0,"amortisation":17409568.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":null,"wages_pct_change":null,"amortisation_pct_change":null,"avg_revenue":224435157.849999994,"total_revenue":4488703157.0,"avg_wages":161771241.150000006,"total_wages":3235424823.0,"avg_amortisation":69520578.400000006,"total_amortisation":1390411568.0,"clubs_awaiting":0},{"year":2024,"team":"Brentford","revenue":166536000.0,"wages":114371000.0,"amortisation":35631000.0,"league":"Premier League","awaitingAccounts":false,"revenue_pct_change":-1.4684826468,"wages_pct_change":15.7601214575,"amortisation_pct_change":15.2994854868,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1},{"year":2024,"team":"Burnley","revenue":null,"wages":null,"amortisation":null,"league":"Premier League","awaitingAccounts":true,"revenue_pct_change":0.0,"wages_pct_change":0.0,"amortisation_pct_change":0.0,"avg_revenue":324054036.4210526347,"total_revenue":6157026692.0,"avg_wages":207287456.7368420959,"total_wages":3938461678.0,"avg_amortisation":89675100.6315789521,"total_amortisation":1703826912.0,"clubs_awaiting":1}];
    
    // Process data to ensure consistent types
    var data = rawData.map(function(item) {
      return {
        year: parseInt(item.year),
        team: item.team,
        revenue: parseFloat(item.revenue || 0),
        wages: parseFloat(item.wages || 0),
        amortisation: parseFloat(item.amortisation || 0),
        revenue_pct_change: parseFloat(item.revenue_pct_change || 0),
        wages_pct_change: parseFloat(item.wages_pct_change || 0),
        amortisation_pct_change: parseFloat(item.amortisation_pct_change || 0),
        avg_revenue: parseFloat(item.avg_revenue || 0),
        avg_wages: parseFloat(item.avg_wages || 0),
        avg_amortisation: parseFloat(item.avg_amortisation || 0),
        total_revenue: parseFloat(item.total_revenue || 0),
        total_wages: parseFloat(item.total_wages || 0),
        total_amortisation: parseFloat(item.total_amortisation || 0),
        awaitingAccounts: item.awaitingAccounts === true
      };
    });
    
    // Debug function
    function showDebugInfo() {
      var debugDiv = document.getElementById('debugInfo');
      debugDiv.style.display = debugDiv.style.display === 'none' ? 'block' : 'none';
      
      if (debugDiv.style.display === 'block') {
        var yearSample = {};
        var years = [...new Set(data.map(function(item) { return item.year; }))].sort();
        
        years.forEach(function(y) {
          yearSample[y] = data.filter(function(item) { return item.year === y; }).length;
        });
        
        var selectedYear = parseInt(document.getElementById('yearSelect').value);
        var selectedMetric = document.getElementById('metricSelect').value;
        var filtered = data.filter(function(item) { return item.year === selectedYear; });
        var awaitingCount = filtered.filter(function(item) { return item.awaitingAccounts; }).length;
        
        debugDiv.innerHTML = 'Data counts by year: ' + JSON.stringify(yearSample, null, 2) + 
                            '\n\nSelected year: ' + selectedYear +
                            '\n\nSelected metric: ' + selectedMetric +
                            '\n\nTotal clubs: ' + filtered.length +
                            '\n\nClubs awaiting accounts: ' + awaitingCount +
                            '\n\nFirst few values: ' + JSON.stringify(filtered.slice(0, 3).map(item => {
                              return {
                                team: item.team,
                                [selectedMetric]: item[selectedMetric],
                                awaitingAccounts: item.awaitingAccounts
                              };
                            }), null, 2);
      }
    }
    
    // Populate the year dropdown with unique years from the data
    var years = [...new Set(data.map(function(item) { return item.year; }))].sort();
    var yearSelect = document.getElementById('yearSelect');
    
    years.forEach(function(year) {
      var option = document.createElement('option');
      option.value = year;
      option.text = year;
      yearSelect.appendChild(option);
    });
    
    // Set to most recent year by default
    yearSelect.value = years[years.length - 1]; 
    
    // Function to format currency with proper thousands separators
    function formatCurrency(value) { 
      // Convert to millions with 1 decimal place and ensure it's a number
      const millionsValue = parseFloat((value / 1000000).toFixed(1));
  
      // Format with proper international number formatting using English locale
      const formattedNumber = millionsValue.toLocaleString('en-US', {
        minimumFractionDigits: 1,
        maximumFractionDigits: 1
      });
  
      // Put it all together
      return '£' + formattedNumber + 'M';
    }
    
    function formatPercentage(value) { 
      if (isNaN(value)) return '-';
      return (value > 0 ? '+' : '') + value.toFixed(1) + '%';
    }
    
    // Function to update metrics cards
    function updateMetricsCards(filtered, selectedMetric, selectedYear) {
      // Ensure we have data for the selected year
      if (filtered.length === 0) return;
      
      // Debug logging - Let's see what's in our data
      console.log("Metrics update - Year:", selectedYear);
      console.log("Total records:", filtered.length);
      console.log("Awaiting accounts count:", filtered.filter(function(item) { return item.awaitingAccounts === true; }).length);
      console.log("First few records:", filtered.slice(0, 3));
      
      // Check if any club is awaiting accounts
      var hasAwaitingAccounts = filtered.some(function(item) {
        return item.awaitingAccounts === true;
      });
      
      console.log("Has awaiting accounts:", hasAwaitingAccounts);
      
      // Get only records with actual data (not awaiting accounts)
      var actualDataRecords = filtered.filter(function(item) {
        return item.awaitingAccounts !== true;
      });
      
      // If any club is awaiting accounts, show TBC for league totals
      if (hasAwaitingAccounts) {
        document.getElementById('leagueTotal').textContent = "TBC";
        document.getElementById('totalChange').textContent = "Awaiting all club accounts";
        document.getElementById('totalChange').className = 'metric-change';
      } else {
        // League total - only if all accounts are available
        var totalKey = 'total_' + selectedMetric;
        var total = filtered[0][totalKey]; // All items in filtered have the same total value
        
        document.getElementById('leagueTotal').textContent = formatCurrency(total);
        
        // Calculate total change from previous year if available
        var previousYear = selectedYear - 1;
        var previousYearData = data.filter(function(item) { return item.year === previousYear; });
        
        if (previousYearData.length > 0) {
          var prevTotal = previousYearData[0][totalKey]; // Get total from first record (all have same value)
          
          var totalChange = ((total - prevTotal) / prevTotal) * 100;
          var changeElement = document.getElementById('totalChange');
          changeElement.textContent = formatPercentage(totalChange) + " " + (totalChange >= 0 ? "increase" : "decrease") + " on previous year";
          changeElement.className = 'metric-change ' + (totalChange >= 0 ? 'positive-change' : 'negative-change');
        } else {
          document.getElementById('totalChange').textContent = '-';
          document.getElementById('totalChange').className = 'metric-change';
        }
      }
      
      // Always show available data for highest value
      if (actualDataRecords.length > 0) {
        // Highest value
        var maxValueItem = actualDataRecords.reduce(function(max, item) {
          return item[selectedMetric] > max[selectedMetric] ? item : max;
        }, actualDataRecords[0]);
        
        document.getElementById('highestValue').textContent = formatCurrency(maxValueItem[selectedMetric]);
        document.getElementById('highestClub').textContent = maxValueItem.team;
        
        // Highest year-on-year growth
        var changeKey = selectedMetric + '_pct_change';
        var validGrowthItems = actualDataRecords.filter(function(item) {
          return !isNaN(item[changeKey]);
        });
        
        if (validGrowthItems.length > 0) {
          var maxGrowthItem = validGrowthItems.reduce(function(max, item) {
            return item[changeKey] > max[changeKey] ? item : max;
          }, validGrowthItems[0]);
          
          document.getElementById('highestGrowth').textContent = formatPercentage(maxGrowthItem[changeKey]);
          document.getElementById('growthClub').textContent = maxGrowthItem.team;
        } else {
          document.getElementById('highestGrowth').textContent = '-';
          document.getElementById('growthClub').textContent = '-';
        }
      } else {
        // No actual data available
        document.getElementById('highestValue').textContent = "TBC";
        document.getElementById('highestClub').textContent = "Awaiting Accounts";
        document.getElementById('highestGrowth').textContent = "TBC";
        document.getElementById('growthClub').textContent = "Awaiting Accounts";
      }
    }
    
    // Function to update the bar chart (D3.js implementation)
    function updateBarChart() {
      var selectedYear = parseInt(document.getElementById('yearSelect').value);
      var selectedMetric = document.getElementById('metricSelect').value;
      var sortBy = document.getElementById('sortSelect').value;
      
      console.log("Selected year:", selectedYear, "type:", typeof selectedYear);
      
      // Filter data for the selected year
      var filtered = data.filter(function(item) { 
        return item.year === selectedYear; 
      });
      
      console.log("Filtered data count:", filtered.length);
      console.log("Awaiting accounts count:", filtered.filter(function(item) { return item.awaitingAccounts; }).length);
      
      // Check if there is data for the selected year
      if (filtered.length === 0) {
        document.getElementById('barChart').innerHTML = '<div style="text-align: center; padding: 50px; color: #FF3B30;">No data available for ' + selectedYear + '</div>';
        return;
      }
      
      // Sort data based on selection
      if (sortBy === 'value') {
        filtered.sort(function(a, b) { 
          // Put awaiting accounts at the end
          if (a.awaitingAccounts && !b.awaitingAccounts) return 1;
          if (!a.awaitingAccounts && b.awaitingAccounts) return -1;
          return b[selectedMetric] - a[selectedMetric]; 
        });
      } else if (sortBy === 'name') {
        filtered.sort(function(a, b) { return a.team.localeCompare(b.team); });
      } else if (sortBy === 'change') {
        var changeKey = selectedMetric + '_pct_change';
        filtered.sort(function(a, b) {
          // Put awaiting accounts at the end
          if (a.awaitingAccounts && !b.awaitingAccounts) return 1;
          if (!a.awaitingAccounts && b.awaitingAccounts) return -1;
          if (isNaN(a[changeKey]) && isNaN(b[changeKey])) return 0;
          if (isNaN(a[changeKey])) return 1;
          if (isNaN(b[changeKey])) return -1;
          return b[changeKey] - a[changeKey];
        });
      }
      
      // MODIFIED: Pass ALL filtered data to updateMetricsCards including clubs with awaiting accounts
      // This ensures that the hasAwaitingAccounts check will work properly
      updateMetricsCards(filtered, selectedMetric, selectedYear);
      
      // Clear previous chart
      d3.select("#barChart").html("");
      
      // Set up dimensions
      var chartContainer = document.getElementById('barChart');
      var width = chartContainer.clientWidth;
      var height = chartContainer.clientHeight;
      var margin = {top: 60, right: 40, bottom: 120, left: 80};
      var innerWidth = width - margin.left - margin.right;
      var innerHeight = height - margin.top - margin.bottom;
      
      // Get data ready for chart
      var teams = filtered.map(function(item) { return item.team; });
      
      // Calculate average only from clubs with actual data
      var actualDataItems = filtered.filter(function(item) { return !item.awaitingAccounts; });
      var avgKey = 'avg_' + selectedMetric;
      var average = actualDataItems.length > 0 ? actualDataItems[0][avgKey] : 0;
      
      // Create SVG container
      var svg = d3.select("#barChart")
        .append("svg")
        .attr("width", width)
        .attr("height", height);
      
      // Create main group with margin
      var g = svg.append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
      
      // Set up scales
      var xScale = d3.scaleBand()
        .domain(teams)
        .range([0, innerWidth])
        .padding(0.2);
      
      // Calculate max value only from actual data
      var values = actualDataItems.map(function(item) { return Number(item[selectedMetric]); });
      var maxValue = values.length > 0 ? d3.max(values) : 0;
      
      var yScale = d3.scaleLinear()
        .domain([0, maxValue > 0 ? maxValue : 100]) // Fallback if no actual data
        .range([innerHeight, 0]);
      
      // Color scale for bars
      var colorScale = function(value, awaitingAccounts) {
        if (awaitingAccounts) return "rgba(150, 150, 150, 0.3)";
        return value > average ? '#05D4BE' : '#FF3B30';
      };
      
      // Create bars
      g.selectAll(".bar")
        .data(filtered)
        .enter()
        .append("rect")
        .attr("class", function(d) {
          return d.awaitingAccounts ? "bar awaiting-accounts-bar" : "bar";
        })
        .attr("x", function(d) { return xScale(d.team); })
        .attr("y", function(d) { 
          if (d.awaitingAccounts) { 
            return innerHeight - 30; // Small bar to indicate awaiting accounts
          } else { 
            return yScale(d[selectedMetric]); 
          }
        })
        .attr("width", xScale.bandwidth())
        .attr("height", function(d) { 
          if (d.awaitingAccounts) { 
            return 30; // Fixed height for awaiting accounts
          } else { 
            return innerHeight - yScale(d[selectedMetric]); 
          }
        })
        .attr("fill", function(d) { 
          return colorScale(d[selectedMetric], d.awaitingAccounts);
        })
        .attr("stroke", "rgba(255, 255, 255, 0.5)")
        .attr("stroke-width", 1)
        .on("mouseover", function(event, d) {
          // Highlight bar
          d3.select(this)
            .attr("stroke-width", 2);
          
          // Show tooltip
          var tooltipContent = '<b>' + d.team + '</b><br>';
          
          if (d.awaitingAccounts) {
            tooltipContent += '<i>Awaiting 2024 Financial Accounts</i>';
          } else {
            var changeKey = selectedMetric + '_pct_change';
            var percentFromAvg = ((d[selectedMetric] / d[avgKey]) * 100 - 100).toFixed(1);
            var changeText = isNaN(d[changeKey]) ? 'N/A' : formatPercentage(d[changeKey]);
            
            tooltipContent += selectedMetric.charAt(0).toUpperCase() + selectedMetric.slice(1) + ': ' + formatCurrency(d[selectedMetric]) + '<br>' +
                            'vs League Avg: ' + percentFromAvg + '%<br>' +
                            'YoY Change: ' + changeText;
          }
                              
          var tooltip = d3.select("#tooltip")
            .style("left", (event.pageX + 10) + "px")
            .style("top", (event.pageY - 20) + "px")
            .style("opacity", 1);
            
          tooltip.html(tooltipContent);
        })
        .on("mouseout", function() {
          // Restore bar style
          d3.select(this)
            .attr("stroke-width", 1);
          
          // Hide tooltip
          d3.select("#tooltip")
            .style("opacity", 0);
        });
      
      // Add bar value labels
      g.selectAll(".bar-value")
        .data(filtered)
        .enter()
        .append("text")
        .attr("class", "bar-value")
        .attr("x", function(d) { return xScale(d.team) + xScale.bandwidth() / 2; })
        .attr("y", function(d) { 
          if (d.awaitingAccounts) { 
            return innerHeight - 45; // Position well above the small bar
          } else { 
            return yScale(d[selectedMetric]) - 5; 
          }
        })
        .attr("text-anchor", "middle")
        .style("font-size", function(d) {
          return d.awaitingAccounts ? "8px" : "10px"; // Smaller font for awaiting accounts
        })
        .text(function(d) { 
          if (d.awaitingAccounts) { 
            return "Awaiting"; 
          } else { 
            return formatCurrency(d[selectedMetric]); 
          }
        });
        
      // Add second line for awaiting accounts
      g.selectAll(".bar-value-line2")
        .data(filtered.filter(function(d) { return d.awaitingAccounts; }))
        .enter()
        .append("text")
        .attr("class", "bar-value")
        .attr("x", function(d) { return xScale(d.team) + xScale.bandwidth() / 2; })
        .attr("y", function(d) { return innerHeight - 35; })
        .attr("text-anchor", "middle")
        .style("font-size", "8px")
        .text("Accounts");
      
      // Add X axis
      g.append("g")
        .attr("class", "axis-x")
        .attr("transform", "translate(0," + innerHeight + ")")
        .call(d3.axisBottom(xScale))
        .selectAll("text")
        .attr("transform", "rotate(-45)")
        .style("text-anchor", "end")
        .attr("dx", "-.8em")
        .attr("dy", ".15em");
      
      // Add Y axis
      g.append("g")
        .attr("class", "axis-y")
        .call(d3.axisLeft(yScale)
          .tickFormat(function(d) { return "£" + (d / 1000000).toFixed(0) + "M"; }));
      
      // Add Y axis label
      g.append("text")
        .attr("transform", "rotate(-90)")
        .attr("y", -60)
        .attr("x", -(innerHeight / 2))
        .attr("text-anchor", "middle")
        .style("fill", "white")
        .style("font-size", "14px")
        .text(selectedMetric.charAt(0).toUpperCase() + selectedMetric.slice(1));
      
      // Add title
      svg.append("text")
        .attr("class", "chart-title")
        .attr("x", width / 2)
        .attr("y", 30)
        .text(selectedMetric.charAt(0).toUpperCase() + selectedMetric.slice(1) + " for Premier League Clubs (" + selectedYear + ")");
      
      // Add average line only if we have actual data
      if (actualDataItems.length > 0) {
        g.append("line")
          .attr("class", "average-line")
          .attr("x1", 0)
          .attr("x2", innerWidth)
          .attr("y1", yScale(average))
          .attr("y2", yScale(average));
        
        // Add average label
        g.append("text")
          .attr("class", "average-label")
          .attr("x", innerWidth - 5)
          .attr("y", yScale(average) - 5)
          .attr("text-anchor", "end")
          .text("League Average: " + formatCurrency(average))
          .attr("fill", "white")
          .attr("padding", "4px")
          .attr("background", "rgba(0,0,0,0.5)");
      }
    }
    
    // Function to update the trend chart (D3.js implementation)
    function updateTrendChart() {
      var selectedMetric = document.getElementById('metricSelect').value;
      
      // Clear previous chart
      d3.select("#trendChart").html("");
      
      // Get the averages and totals for each year (limit to 2023)
      var yearlyData = [];
      years.forEach(function(year) {
        // Skip data for 2024 that isn't complete
        if (year > 2023) {
          return;
        }
        
        var yearData = data.filter(function(item) { return item.year === year; });
        if (yearData.length > 0) {
          var totalKey = 'total_' + selectedMetric;
          var total = yearData[0][totalKey]; // All records for this year have the same total
          
          var maxItem = yearData.reduce(function(max, item) { 
            return item[selectedMetric] > max[selectedMetric] ? item : max; 
          }, yearData[0]);
          
          yearlyData.push({
            year: year,
            total: total,
            max: maxItem[selectedMetric],
            maxClub: maxItem.team
          });
        }
      });
      
      // Set up dimensions
      var chartContainer = document.getElementById('trendChart');
      var width = chartContainer.clientWidth;
      var height = chartContainer.clientHeight;
      var margin = {top: 50, right: 40, bottom: 60, left: 80};
      var innerWidth = width - margin.left - margin.right;
      var innerHeight = height - margin.top - margin.bottom;
      
      // Create SVG container
      var svg = d3.select("#trendChart")
        .append("svg")
        .attr("width", width)
        .attr("height", height);
      
      // Create main group with margin
      var g = svg.append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
      
      // Set up scales
      var xScale = d3.scaleBand()
        .domain(yearlyData.map(function(d) { return d.year; }))
        .range([0, innerWidth])
        .padding(0.2);
      
      var maxTotal = d3.max(yearlyData, function(d) { return d.total; });
      var maxValue = d3.max(yearlyData, function(d) { return d.max; });
      var yMax = Math.max(maxTotal, maxValue);
      
      var yScale = d3.scaleLinear()
        .domain([0, yMax])
        .range([innerHeight, 0]);
      
      // Create line generators
      var totalLine = d3.line()
        .x(function(d) { return xScale(d.year) + xScale.bandwidth() / 2; })
        .y(function(d) { return yScale(d.total); })
        .curve(d3.curveMonotoneX);
      
      var maxLine = d3.line()
        .x(function(d) { return xScale(d.year) + xScale.bandwidth() / 2; })
        .y(function(d) { return yScale(d.max); })
        .curve(d3.curveMonotoneX);
      
      // Add X axis
      g.append("g")
        .attr("class", "axis-x")
        .attr("transform", "translate(0," + innerHeight + ")")
        .call(d3.axisBottom(xScale));
      
      // Add Y axis
      g.append("g")
        .attr("class", "axis-y")
        .call(d3.axisLeft(yScale)
          .tickFormat(function(d) { return "£" + (d / 1000000).toFixed(0) + "M"; }));
      
      // Add Y axis label
      g.append("text")
        .attr("transform", "rotate(-90)")
        .attr("y", -60)
        .attr("x", -(innerHeight / 2))
        .attr("text-anchor", "middle")
        .style("fill", "white")
        .style("font-size", "14px")
        .text(selectedMetric.charAt(0).toUpperCase() + selectedMetric.slice(1));
      
      // Add title
      svg.append("text")
        .attr("class", "chart-title")
        .attr("x", width / 2)
        .attr("y", 20)
        .text(selectedMetric.charAt(0).toUpperCase() + selectedMetric.slice(1) + " Trends (2015-2023)");
      
      // Draw total line
      g.append("path")
        .datum(yearlyData)
        .attr("fill", "none")
        .attr("stroke", "#05D4BE")
        .attr("stroke-width", 3)
        .attr("d", totalLine);
      
      // Draw max line
      g.append("path")
        .datum(yearlyData)
        .attr("fill", "none")
        .attr("stroke", "#FF9500")
        .attr("stroke-width", 3)
        .attr("d", maxLine);
      
      // Add points for total
      g.selectAll(".total-point")
        .data(yearlyData)
        .enter()
        .append("circle")
        .attr("class", "total-point")
        .attr("cx", function(d) { return xScale(d.year) + xScale.bandwidth() / 2; })
        .attr("cy", function(d) { return yScale(d.total); })
        .attr("r", 6)
        .attr("fill", "#05D4BE")
        .attr("stroke", "white")
        .attr("stroke-width", 1)
        .on("mouseover", function(event, d) {
          // Highlight point
          d3.select(this)
            .attr("r", 8)
            .attr("stroke-width", 2);
          
          // Show tooltip
          var tooltipContent = 'Year: ' + d.year + '<br>Total ' + 
                             selectedMetric + ': ' + formatCurrency(d.total);
                             
          var tooltip = d3.select("#tooltip")
            .style("left", (event.pageX + 10) + "px")
            .style("top", (event.pageY - 20) + "px")
            .style("opacity", 1);
            
          tooltip.html(tooltipContent);
        })
        .on("mouseout", function() {
          // Restore point style
          d3.select(this)
            .attr("r", 6)
            .attr("stroke-width", 1);
          
          // Hide tooltip
          d3.select("#tooltip")
            .style("opacity", 0);
        });
      
      // Add points for max
      g.selectAll(".max-point")
        .data(yearlyData)
        .enter()
        .append("circle")
        .attr("class", "max-point")
        .attr("cx", function(d) { return xScale(d.year) + xScale.bandwidth() / 2; })
        .attr("cy", function(d) { return yScale(d.max); })
        .attr("r", 6)
        .attr("fill", "#FF9500")
        .attr("stroke", "white")
        .attr("stroke-width", 1)
        .on("mouseover", function(event, d) {
          // Highlight point
          d3.select(this)
            .attr("r", 8)
            .attr("stroke-width", 2);
          
          // Show tooltip
          var tooltipContent = 'Year: ' + d.year + '<br>Highest ' + 
                             selectedMetric + ': ' + formatCurrency(d.max) + 
                             '<br>Club: ' + d.maxClub;
                             
          var tooltip = d3.select("#tooltip")
            .style("left", (event.pageX + 10) + "px")
            .style("top", (event.pageY - 20) + "px")
            .style("opacity", 1);
            
          tooltip.html(tooltipContent);
        })
        .on("mouseout", function() {
          // Restore point style
          d3.select(this)
            .attr("r", 6)
            .attr("stroke-width", 1);
          
          // Hide tooltip
          d3.select("#tooltip")
            .style("opacity", 0);
        });
      
      // Add legend
      var legend = svg.append("g")
        .attr("transform", "translate(" + (width/2 - 100) + "," + (margin.top - 20) + ")");
      
      // Legend for total
      legend.append("rect")
        .attr("x", 0)
        .attr("width", 20)
        .attr("height", 10)
        .attr("fill", "#05D4BE");
        
      legend.append("text")
        .attr("x", 30)
        .attr("y", 8)
        .text("League Total")
        .attr("font-size", "12px")
        .attr("fill", "white");
      
      // Legend for max
      legend.append("rect")
        .attr("x", 150)
        .attr("width", 20)
        .attr("height", 10)
        .attr("fill", "#FF9500");
        
      legend.append("text")
        .attr("x", 180)
        .attr("y", 8)
        .text("Highest Value")
        .attr("font-size", "12px")
        .attr("fill", "white");
    }
    
    // Event listeners
    document.getElementById('yearSelect').addEventListener('change', updateBarChart);
    document.getElementById('metricSelect').addEventListener('change', function() {
      updateBarChart();
      updateTrendChart();
    });
    document.getElementById('sortSelect').addEventListener('change', updateBarChart);
    
    // Add event listener for debug function
    document.getElementById('barChart').addEventListener('dblclick', showDebugInfo);
    document.getElementById('trendChart').addEventListener('dblclick', showDebugInfo);
    
    // Initial render
    updateBarChart();
    updateTrendChart();
  </script>
</body>
</html>
